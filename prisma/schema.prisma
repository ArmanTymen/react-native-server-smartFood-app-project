// This is your Prisma schema file,

generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  personalRation PersonalRation?  // ← исправить регистр
  favorites      Favorites[]
}

model PersonalRation {  // ← исправить регистр (PascalCase)
  id            Int      @id @default(autoincrement())
  userId        Int      @unique
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  weight        Float?
  height        Float?
  age           Int?
  gender        Gender? @default(MALE)
  activityLevel ActivityLevel? @default(MEDIUM)
  goal          Goal? @default(MAINTAIN)
  dietType      DietType @default(NONE)
  allergies     Allergies @default(NO)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Allergies {
  NO
  YES  // ← UPPERCASE для enum значений
}

enum Gender {
  MALE
  FEMALE
}

enum ActivityLevel {
  LOW
  MEDIUM
  HIGH
}

enum Goal {
  LOSE
  MAINTAIN
  GAIN
}

enum DietType {
  NONE
  VEGAN
  KETO
  BALANCED
  CUSTOM
}

model Category {
  id       Int       @id @default(autoincrement())
  name     String    @unique
  articles Article[]
}

model Article {
  id         Int      @id @default(autoincrement())
  title      String
  content    String
  categoryId Int
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  favorites Favorites[]
}

model Favorites {
  id        Int      @id @default(autoincrement())
  userId    Int
  articleId Int
  createdAt DateTime @default(now())

  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  article Article @relation(fields: [articleId], references: [id], onDelete: Cascade)

  @@unique([userId, articleId])  // ← предотвратить дубликаты
}